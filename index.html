<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>积善时间舱</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
  <link rel="stylesheet" href="css/style.css">

  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/icon?family=Material+Icons'>


  <script type="text/javascript">
    // 判断是否是微信浏览器
    window.onload = function is_weixin() {
      var ua = navigator.userAgent.toLowerCase();
      var weixin = document.getElementById("weixin");
      if (ua.match(/MicroMessenger/i) == "micromessenger") {

        if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
          weixin.innerHTML = "<div id=\"weixin-tip\"><p><img src=\"img/Ios.png\" alt=\"微信打开\"/></p></div>";
        } else if (navigator.userAgent.match(/android/i)) {
          weixin.innerHTML = "<div id=\"weixin-tip\"><p><img src=\"img/Android.png\" alt=\"微信打开\"/></p></div>";
        } else {
          weixin.innerHTML = "<div id=\"weixin-tip\"><p><img src=\"img/Android.png\" alt=\"微信打开\"/></p></div>";
        }

        //alert("微信浏览器");
        //return true;

      } else {
        //alert("微信浏览器，请使用其他浏览器打开");
        //alert("非微信浏览器");
        //return false;


      }
    }


    function open_or_download_app() {
      if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {　　　　　　　　　　　 // 判断useragent，当前设备为ios设备
        var loadDateTime = new Date();　　　　　　　　　　　　 // 设置时间阈值，在规定时间里面没有打开对应App的话，直接去App store进行下载。
        window.setTimeout(function() {
            var timeOutDateTime = new Date();
            if (timeOutDateTime - loadDateTime < 5000) {
              var r = confirm("即将跳转到下载页面！");
              if (r == true) {
                //点击确定
                window.location.href = "https://fir.im/zbvq";
              } else {
                //点击取消
              }

            } else {
              window.close();
            }
          },
          25);
        window.location = "timecapsule://open";　　 // ios端URL Schema
      } else if (navigator.userAgent.match(/android/i)) {
        var loadDateTime = new Date();　　　　　　　　　　　　 // 设置时间阈值，在规定时间里面没有打开对应App的话，直接去App store进行下载。
        window.setTimeout(function() {
            var timeOutDateTime = new Date();
            if (timeOutDateTime - loadDateTime < 5000) {
              var r = confirm("即将跳转到下载页面！");
              if (r == true) {
                //点击确定
                window.location.href = "https://fir.im/s7av";
              } else {
                //点击取消
              }

            } else {
              window.close();
            }
          },
          25);　　　　　　　　　　　　 // 判断useragent，当前设备为安卓设备
        　　　　　　　　　　　　
        window.location = "timecapsule://open";　　 // Android端URL Schema
        　　　　　　　　　
      } else {
        document.getElementById("weixin").innerHTML =
          "<div id=\"weixin-tip\"><p>请使用手机下载App登陆<br><br><img src=\"img/DIos.png\"><br><a href=\"https://fir.im/zbvq\">Ios</a><br><br><img src=\"img/Dandroid.png\"><br><a href=\"https://fir.im/s7av\">Android</a></p></div>";
        //window.location.href = "http://www.patimecapsule.com/";
      }

    }



    function jump() {
      var u = navigator.userAgent;
      var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android
      var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios
      if (isAndroid == 1) {
        window.location.href = "timecapsule://open";
      } else if (isiOS == 1) {
        window.location.href = "ios.jsp";
      } else {

      }
    }
    /* alert('是否是Android：'+isAndroid);
    alert('是否是iOS：'+isiOS); */
    var InterValObj; //timer变量，控制时间
    var count = 60; //间隔函数，1秒执行
    var curCount; //当前剩余秒数


    function btn_code() {
      curCount = count;
      var btn_code = document.getElementById("btn_code");
      if (judge1() != true) {
        alert("请检查您的手机号");
        return false;
      }
      //禁用按钮
      btn_code.disabled = true;
      btn_code.innerHTML = (curCount + "\'");
      InterValObj = window.setInterval(SetRemainTime, 1000);

    }


    //timer处理函数
    function SetRemainTime() {
      var btn_code = document.getElementById("btn_code");
      if (curCount == 0) {
        window.clearInterval(InterValObj); //停止计时器
        btn_code.innerHTML = ("<font size=\"1\">" + "重新发送" + "</font>");
        //启用按钮
        btn_code.disabled = false;
      } else {
        curCount--;
        btn_code.innerHTML = (curCount + "\'");
      }
    }

    function hint_time(){

      var hint = document.getElementById("hint");
      hint.innerHTML = "<div class=\"hint\">手机号不能为空</div>";
      setTimeout(function(){  //使用  setTimeout（）方法设定定时2000毫秒
      hint.innerHTML = "";
    },1500);
    }

    function judge() {
      if (judge1() != true) {
        alert("请检查您的手机号");
      } else if (judge2() != true) {
        alert("请检查您的验证码");
      } else if (judge3() != true) {
        alert("请检查您的密码");
      } else if (judge4() != true) {
        alert("请检查您的确认密码");
      }
    }

    function judge1() {
      var PhoneNumber = document.getElementById("PhoneNumber").value;
      var ts = document.getElementById("ts");
      var PhoneNumberdiv = document.getElementById("PhoneNumberdiv");
      var mobile = /^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/;
      //匹配数字
      if (PhoneNumber == "") {
        hint_time();
        return false;
      } else if (!mobile.test(PhoneNumber)) {
        PhoneNumberdiv.innerHTML = "请输入正确手机号格式";
        return false;
      } else {
        PhoneNumberdiv.innerHTML = "";
        return true;
      }
    }

    function judge2() {
      var yanzheng = document.getElementById("yanzheng").value;
      var ts = document.getElementById("ts").value;
      var yanzhengdiv = document.getElementById("yanzhengdiv");
      //匹配数字
      if (yanzheng == "") {
        yanzhengdiv.innerHTML = "验证码不能为空";
        return false;
      } else {
        yanzhengdiv.innerHTML = "";
        return true;
      }
    }

    function judge3() {
      var password = document.getElementById("password").value;
      var passworddiv = document.getElementById("passworddiv");
      //正则（密码由6~20位字母数字组成）
      var pass = /^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,20}$/;
      //匹配数字
      if (password == "") {
        passworddiv.innerHTML = "密码不能为空";
        return false;
      } else if (!pass.test(password)) {
        passworddiv.innerHTML = "密码由字母数字组合(6~20位)";
        return false;
      } else {
        passworddiv.innerHTML = "";
        return true;
      }
    }

    function judge4() {
      var password = document.getElementById("password").value;
      var password1 = document.getElementById("password1").value;
      var passworddiv1 = document.getElementById("passworddiv1");
      //匹配数字
      if (password1 == "") {
        passworddiv1.innerHTML = "密码不能为空";
        return false;
      } else if (password != password1) {
        passworddiv1.innerHTML = "两次输入密码不一致  请重新输入";
        return false;
      } else {
        passworddiv1.innerHTML = "";
        return true;
      }
    }
  </script>

</head>

<body>
  <div id="weixin"></div>

  <div class="cont_centrar">
    <div class="cont_login">
      <div class="cont_forms"><div  id="hint" style="color:#ffffff" ></div>
        <div class="cont_form_sign_up">
          <img class="img_logo" src="img/js.png" alt="" style="" />
          <input type="text" id="PhoneNumber" name="PhoneNumber" placeholder="　手机号" onblur="judge1()" />
          <hr>
          <div id="PhoneNumberdiv" style="color:#BA9257"></div>
          <div class="code">
            <input type="text" placeholder="　验证码" id="yanzheng" name="yanzheng" onblur="judge2()" /><button class="btn_code" id="btn_code" onClick="btn_code()">获取验证码</button>
          </div>
          <hr>
          <div id="yanzhengdiv" style="color:#BA9257"></div>
          <input type="password" placeholder="　密码" id="password" name="password" onblur="judge3()" />
          <hr>
          <div id="passworddiv" style="color:#BA9257"></div>
          <input type="password" placeholder="　确认密码" id="password1" name="password1" onblur="judge4()" />
          <hr>
          <div id="passworddiv1" style="color:#BA9257"></div>
          <br>
          <button class="btn_sign_up" onClick="judge()">注册</button>
          <br>
          <a onClick="open_or_download_app()">
            <font size="1">已有账号 请立即登录</font>
          </a>
          <!-- <button class="btn_login" onClick="ocultar_login_sign_up()">返回</button> -->
        </div>
      </div>

    </div>
  </div>



</body>

</html>
